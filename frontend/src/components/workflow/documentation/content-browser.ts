export const browserGuideContent = `# 🌐 自动化浏览器详解

本章详细介绍自动化浏览器的工作原理、配置方法和使用技巧。

---

## 🔧 什么是自动化浏览器？

Web RPA 使用 **Playwright** 驱动浏览器执行自动化任务。默认使用 **Microsoft Edge**，也支持 **Chrome**、**Chromium** 和 **Firefox**。

### 核心特点

| 特点 | 说明 |
|------|------|
| 真实浏览器 | 使用真实的浏览器，而非模拟器 |
| 多浏览器支持 | 支持 Edge、Chrome、Chromium、Firefox |
| 登录状态保持 | 浏览器数据持久化，登录状态自动保存 |
| 可视化操作 | 可以看到浏览器执行过程 |
| 元素选择器 | 支持可视化选择网页元素 |

### 浏览器数据目录

浏览器的所有数据（Cookie、登录状态、缓存等）保存在：
\`\`\`
backend/browser_data/{浏览器类型}/
\`\`\`

例如：
- Edge: \`backend/browser_data/msedge/\`
- Chrome: \`backend/browser_data/chrome/\`
- Firefox: \`backend/browser_data/firefox/\`

这意味着：
- 登录一次网站后，下次运行工作流无需重新登录
- 不同浏览器的数据相互独立
- 可以手动清理该目录来重置浏览器状态

---

## ⚙️ 浏览器配置

### 切换浏览器类型

1. 点击顶部工具栏的 **⚙️ 全局配置** 按钮
2. 选择 **浏览器** 标签页
3. 选择你想使用的浏览器类型：
   - **Microsoft Edge**（默认）：Windows 系统自带
   - **Google Chrome**：需要安装 Chrome 浏览器
   - **Chromium**：Chrome 的开源版本
   - **Firefox**：需要安装 Firefox 浏览器

4. 如果浏览器无法启动，可以手动指定浏览器可执行文件路径

### 注意事项

- 修改浏览器配置后，需要**关闭并重新打开**浏览器才能生效
- 不同浏览器的数据目录是独立的，切换浏览器后需要重新登录网站
- 推荐使用 Edge 或 Chrome，兼容性最好

---

## 🚀 打开自动化浏览器

### 方式一：工具栏按钮

点击顶部工具栏的 **🌐 自动化浏览器** 按钮，可以：
- 打开/关闭浏览器
- 导航到指定网址
- 启动元素选择器

### 方式二：运行工作流

当工作流中包含"打开网页"模块时，会自动启动浏览器。

---

## 🎯 元素选择器

元素选择器是 Web RPA 的核心功能，让你无需编写 CSS 选择器就能定位网页元素。

### 启动方式

1. **工具栏启动**：点击"自动化浏览器" → "启动选择器"
2. **配置面板启动**：点击选择器输入框旁的 🎯 按钮

### 选择模式

| 操作 | 功能 | 使用场景 |
|------|------|----------|
| **Ctrl + 点击** | 选择单个元素 | 选择按钮、输入框等 |
| **Shift + 点击** | 选择相似元素 | 选择列表项、表格行等 |
| **Esc** | 取消选择 | 重新选择 |

### 单元素选择

1. 启动选择器
2. 按住 **Ctrl** 键
3. 点击目标元素
4. 选择器自动填入配置

### 相似元素选择

用于选择多个结构相似的元素（如商品列表）：

1. 启动选择器
2. 按住 **Shift** 键
3. 点击第一个元素
4. 点击第二个相似元素
5. 系统自动识别所有相似元素

**生成的选择器示例**：
\`\`\`css
.product-list > div:nth-child({index})
\`\`\`

其中 \`{index}\` 是变量，配合循环使用可遍历所有元素。

---

## 🔄 页面导航

### 打开网页

\`\`\`
模块：打开网页
网址：https://www.example.com
等待条件：load（页面完全加载）
\`\`\`

### 等待条件详解

| 条件 | 说明 | 适用场景 |
|------|------|----------|
| load | 等待所有资源加载完成 | 普通网页 |
| domcontentloaded | DOM 加载完成即可 | 快速响应 |
| networkidle | 网络空闲 | Ajax 动态页面 |

### 页面跳转

| 模块 | 功能 |
|------|------|
| 刷新页面 | 重新加载当前页面 |
| 返回上一页 | 浏览器后退 |
| 前进下一页 | 浏览器前进 |
| 关闭页面 | 关闭当前标签页 |

---

## 💬 处理弹窗

### 浏览器原生弹窗

处理 \`alert\`、\`confirm\`、\`prompt\` 弹窗：

| 弹窗类型 | 处理方式 |
|----------|----------|
| alert | 点击确定 |
| confirm | 点击确定或取消 |
| prompt | 输入文本后确定 |

**配置示例**：
\`\`\`
模块：处理弹窗
操作：确认（点击确定）
输入文本：验证码123（仅 prompt 需要）
\`\`\`

### 网页自定义弹窗

网页自定义的弹窗（非浏览器原生）需要用普通的点击操作处理：
\`\`\`
1. 等待元素：.modal-dialog 出现
2. 点击元素：.modal-confirm-btn
\`\`\`

---

## ⚡ 性能优化

### 减少等待时间

\`\`\`
❌ 不推荐：固定等待 5000 毫秒
✅ 推荐：等待元素 #content 出现
\`\`\`

### 合理设置超时

| 场景 | 建议超时 |
|------|----------|
| 普通页面加载 | 30秒 |
| 复杂页面/慢网络 | 60秒 |
| 元素等待 | 10秒 |
| 文件下载 | 根据文件大小 |

### 避免频繁操作

\`\`\`
❌ 不推荐：
点击 → 立即获取数据

✅ 推荐：
点击 → 等待元素出现 → 获取数据
\`\`\`

---

## 🛡️ 反检测说明

Web RPA 使用真实浏览器，但某些网站可能检测自动化行为。

### 降低检测风险

1. **添加随机延迟**：操作之间加入随机等待
2. **模拟人类行为**：不要操作过快
3. **保持登录状态**：使用持久化的浏览器数据
4. **合理的请求频率**：避免短时间大量请求

### 示例：添加随机延迟

\`\`\`
循环执行
  ├─ 执行操作
  ├─ 随机数：1000 到 3000
  └─ 等待：{随机数} 毫秒
\`\`\`

---

## 🐛 常见问题

### 浏览器打不开

**可能原因**：
- 选择的浏览器未安装
- 端口被占用
- 权限不足
- 自定义路径不正确

**解决方法**：
1. 确保安装了对应的浏览器（Edge/Chrome/Firefox）
2. 关闭其他占用浏览器的程序
3. 以管理员身份运行
4. 在全局配置中检查浏览器路径设置
5. 尝试切换到其他浏览器类型

### 元素找不到

**可能原因**：
- 选择器不正确
- 元素在 iframe 中
- 元素动态加载

**解决方法**：
1. 使用元素选择器重新选择
2. 添加等待元素模块
3. 检查是否需要切换 iframe

### 登录状态丢失

**可能原因**：
- 浏览器数据目录被清理
- 网站 Cookie 过期

**解决方法**：
1. 重新登录一次
2. 检查 browser_data 目录是否存在

---

## 📝 最佳实践

### 工作流开始

\`\`\`
1. 打开网页
2. 等待关键元素出现
3. 检查登录状态
4. 开始执行任务
\`\`\`

### 工作流结束

\`\`\`
1. 保存数据
2. 打印完成日志
3. （可选）关闭页面
4. （可选）播放提示音
\`\`\`

### 错误处理

\`\`\`
条件判断：{元素存在} == true
  ├─ 真 → 继续执行
  └─ 假 → 打印错误日志 → 跳出循环
\`\`\``
