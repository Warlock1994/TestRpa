export const excelGuideContent = `# 📊 Excel与数据表格

本章详细介绍 Excel 文件操作和数据表格功能。

---

## 📁 Excel文件资源

### 什么是Excel文件资源？

Excel文件资源是上传到系统中的 Excel 文件，可以在工作流中读取和使用。

### 上传Excel文件

1. 点击顶部工具栏的 **📊 Excel资源** 按钮
2. 点击 **上传文件**
3. 选择 .xlsx 或 .xls 文件
4. 文件上传后可在工作流中使用

### 支持的格式

| 格式 | 说明 |
|------|------|
| .xlsx | Excel 2007+ 格式（推荐） |
| .xls | Excel 97-2003 格式 |

### 文件管理

- **预览**：点击文件可预览内容
- **删除**：删除不需要的文件
- **刷新**：重新加载文件列表

---

## 📖 读取Excel

### 基本配置

| 参数 | 说明 |
|------|------|
| 文件 | 选择已上传的Excel文件 |
| 工作表 | 选择要读取的工作表 |
| 保存到变量 | 存储数据的变量名 |

### 数据格式

读取后的数据是一个**列表**，每行是一个**字典**：

**Excel内容**：
| 姓名 | 年龄 | 城市 |
|------|------|------|
| 张三 | 25 | 北京 |
| 李四 | 30 | 上海 |

**读取后的变量**：
\`\`\`json
[
  {"姓名": "张三", "年龄": 25, "城市": "北京"},
  {"姓名": "李四", "年龄": 30, "城市": "上海"}
]
\`\`\`

### 使用数据

**遍历所有行**：
\`\`\`
读取Excel → 保存到：数据列表

遍历列表：数据列表
  ├─ 打印日志：姓名={item[姓名]}，年龄={item[年龄]}
  └─ 其他操作...
\`\`\`

**访问特定行**：
\`\`\`
{数据列表[0]}        → 第一行数据
{数据列表[0][姓名]}  → 第一行的姓名
{数据列表[-1]}       → 最后一行数据
\`\`\`

---

## 📋 数据表格

数据表格是 Web RPA 内置的数据收集功能，用于在工作流执行过程中收集和管理数据。

### 查看数据表格

点击底部日志面板的 **📊 数据表格** 标签页。

### 功能特点

| 功能 | 说明 |
|------|------|
| 自动收集 | 配置"存储的列名"后自动收集 |
| 实时预览 | 执行过程中实时显示数据 |
| 手动编辑 | 可以手动修改单元格内容 |
| 导出CSV | 一键导出为CSV文件 |

---

## ➕ 数据表格操作模块

### 添加行

向数据表格添加一行数据。

**配置**：
| 参数 | 说明 | 示例 |
|------|------|------|
| 行数据 | JSON格式的行数据 | \`{"姓名": "{name}", "价格": "{price}"}\` |

**示例**：
\`\`\`json
{
  "商品名": "{商品名称}",
  "价格": "{商品价格}",
  "链接": "{商品链接}"
}
\`\`\`

### 添加列

向数据表格添加新列。

**配置**：
| 参数 | 说明 |
|------|------|
| 列名 | 新列的名称 |
| 默认值 | 新列的默认值（可选） |

### 设置单元格

修改指定单元格的值。

**配置**：
| 参数 | 说明 | 示例 |
|------|------|------|
| 行索引 | 行号（从0开始） | 0、{index} |
| 列名 | 列的名称 | 状态 |
| 值 | 要设置的值 | 已处理 |

### 读取单元格

获取指定单元格的值。

**配置**：
| 参数 | 说明 |
|------|------|
| 行索引 | 行号（从0开始） |
| 列名 | 列的名称 |
| 保存到变量 | 存储值的变量名 |

### 删除行

删除指定行。

**配置**：
| 参数 | 说明 |
|------|------|
| 行索引 | 要删除的行号 |

### 清空表格

清空所有数据。

### 导出表格

将数据表格导出为文件。

**配置**：
| 参数 | 说明 | 示例 |
|------|------|------|
| 文件路径 | 保存位置 | C:/data/result.csv |
| 文件格式 | CSV 或 Excel | csv |

---

## 🔄 数据采集工作流

### 基本模式

\`\`\`
打开网页
  ↓
循环执行（翻页）
  ├─ 获取元素信息（配置列名自动收集）
  ├─ 点击下一页
  └─ 等待加载
  ↓
导出表格
\`\`\`

### 自动收集 vs 手动添加

**自动收集**（推荐）：
在"获取元素信息"模块中配置"存储的列名"，数据自动添加到表格。

**手动添加**：
使用"添加行"模块手动构建数据行。

### 示例：采集商品列表

\`\`\`
1. 打开网页：商品列表页
2. 循环执行 10 次（采集10页）
   ├─ 遍历列表：商品元素
   │   ├─ 获取元素信息：商品名 → 列名"名称"
   │   ├─ 获取元素信息：价格 → 列名"价格"
   │   └─ 获取元素信息：链接 → 列名"链接"
   ├─ 点击下一页
   └─ 等待页面加载
3. 导出表格：C:/采集结果.csv
4. 播放提示音
\`\`\`

---

## 📤 导出数据

### CSV格式

- 通用格式，Excel可直接打开
- 支持中文（UTF-8编码）
- 适合数据交换

### 手动导出

1. 打开数据表格面板
2. 点击 **下载CSV** 按钮
3. 选择保存位置

### 自动导出

使用"导出表格"模块在工作流中自动导出：
\`\`\`
导出表格
  文件路径：C:/data/{日期}_结果.csv
  格式：CSV
\`\`\`

---

## 💡 最佳实践

### 数据去重

\`\`\`
遍历采集的数据
  ├─ 条件判断：是否已存在
  │   ├─ 是 → 跳过
  │   └─ 否 → 添加到表格
\`\`\`

### 数据验证

\`\`\`
获取数据后
  ├─ 条件判断：数据是否有效
  │   ├─ 是 → 保存
  │   └─ 否 → 记录错误日志
\`\`\`

### 增量采集

\`\`\`
1. 读取已有数据（Excel文件）
2. 采集新数据
3. 对比去重
4. 追加新数据
5. 导出更新后的文件
\`\`\`

### 大数据量处理

- 分批采集，每批导出一次
- 避免内存占用过大
- 定期清空数据表格

---

## 🐛 常见问题

### Excel读取乱码

**原因**：文件编码问题
**解决**：确保Excel文件是标准格式，避免特殊字符

### 数据丢失

**原因**：工作流中断未保存
**解决**：
- 定期导出数据
- 使用"导出表格"模块自动保存

### 列名不匹配

**原因**：Excel列名与代码中不一致
**解决**：检查Excel第一行的列名，确保完全匹配

### 数字变成文本

**原因**：Excel单元格格式问题
**解决**：在Excel中设置正确的单元格格式`
