export const practicalCasesContent = `# 📚 实战案例

本章提供常见自动化场景的完整解决方案，可以直接参考或修改使用。

---

## 🔐 案例1：自动登录

### 场景描述
自动登录网站，适用于签到、数据采集前的登录等场景。

### 工作流设计

\`\`\`
1. 打开网页 → 登录页面URL
2. 等待元素 → 等待登录表单加载
3. 输入文本 → 用户名
4. 输入文本 → 密码
5. 点击元素 → 登录按钮
6. 等待元素 → 等待登录成功标志
\`\`\`

### 详细配置

**步骤1：打开网页**
\`\`\`
网址：https://example.com/login
等待条件：domcontentloaded
\`\`\`

**步骤2：等待元素**
\`\`\`
选择器：#login-form
等待条件：出现
超时：10000
\`\`\`

**步骤3：输入用户名**
\`\`\`
选择器：#username
输入内容：{用户名}
清空原有内容：是
\`\`\`

**步骤4：输入密码**
\`\`\`
选择器：#password
输入内容：{密码}
清空原有内容：是
\`\`\`

**步骤5：点击登录**
\`\`\`
选择器：#login-btn
点击类型：单击
\`\`\`

**步骤6：等待登录成功**
\`\`\`
选择器：.user-avatar 或 .welcome-message
等待条件：出现
超时：15000
\`\`\`

### 处理验证码

如果有验证码，可以：

**方案1：AI视觉识别**
\`\`\`
1. 元素截图 → 验证码图片
2. AI视觉 → 识别验证码
3. 输入文本 → 输入识别结果
\`\`\`

**方案2：人工输入**
\`\`\`
1. 用户输入 → 提示"请输入验证码"
2. 输入文本 → 输入用户输入的验证码
\`\`\`

---

## 📊 案例2：商品数据采集

### 场景描述
采集电商网站的商品列表数据，包括名称、价格、链接等。

### 工作流设计

\`\`\`
1. 打开网页 → 商品列表页
2. 等待元素 → 等待商品加载
3. 获取元素信息 → 获取所有商品选择器
4. 遍历列表 → 遍历每个商品
   ├─ 获取元素信息 → 商品名称 → Excel列名：名称
   ├─ 获取元素信息 → 商品价格 → Excel列名：价格
   └─ 获取元素信息 → 商品链接 → Excel列名：链接
\`\`\`

### 详细配置

**步骤1：打开网页**
\`\`\`
网址：https://example.com/products?keyword={搜索关键词}
\`\`\`

**步骤2：等待商品加载**
\`\`\`
选择器：.product-list .product-item
等待条件：出现
\`\`\`

**步骤3：获取商品元素列表**
\`\`\`
选择器：.product-list .product-item
提取类型：元素列表
保存到变量：商品元素列表
\`\`\`

**步骤4：遍历采集**
\`\`\`
遍历列表：商品元素列表（直接填变量名，不加花括号）

内部模块：
- 获取元素信息
  选择器：{item} .product-title
  提取类型：文本内容
  存储的列名：商品名称

- 获取元素信息
  选择器：{item} .product-price
  提取类型：文本内容
  存储的列名：价格

- 获取元素信息
  选择器：{item} a
  提取类型：属性值
  属性名：href
  存储的列名：链接
\`\`\`

### 翻页采集

\`\`\`
设置变量：当前页 = 1
设置变量：总页数 = 10

循环执行（{当前页} <= {总页数}）
  ├─ 采集当前页数据（上面的遍历流程）
  ├─ 条件判断：是否有下一页
  │   ├─ 有 → 点击下一页按钮
  │   │       等待页面加载
  │   │       设置变量：当前页 = {当前页} + 1
  │   └─ 无 → 跳出循环
\`\`\`

---

## 📰 案例3：新闻文章采集

### 场景描述
采集新闻网站的文章列表和详情内容。

### 工作流设计

\`\`\`
1. 打开网页 → 新闻列表页
2. 获取所有文章链接
3. 遍历链接列表
   ├─ 打开文章页面
   ├─ 获取标题 → Excel列名：标题
   ├─ 获取时间 → Excel列名：发布时间
   ├─ 获取内容 → Excel列名：正文
   └─ 等待（避免请求过快）
\`\`\`

### 详细配置

**获取文章链接列表**
\`\`\`
选择器：.news-list a.news-title
提取类型：属性值
属性名：href
保存到变量：文章链接列表
\`\`\`

**遍历采集详情**
\`\`\`
遍历列表：文章链接列表（直接填变量名）

- 打开网页：{item}
- 等待元素：.article-content 出现

- 获取元素信息
  选择器：h1.article-title
  提取类型：文本内容
  存储的列名：标题

- 获取元素信息
  选择器：.publish-time
  提取类型：文本内容
  存储的列名：发布时间

- 获取元素信息
  选择器：.article-content
  提取类型：文本内容
  存储的列名：正文

- 等待：1000毫秒（避免请求过快）
\`\`\`

---

## 💰 案例4：价格监控

### 场景描述
定期检查商品价格，降价时发送通知。

### 工作流设计

\`\`\`
1. 设置变量 → 目标价格
2. 打开商品页面
3. 获取当前价格
4. 条件判断 → 当前价格 < 目标价格
   ├─ 是 → 发送邮件通知
   └─ 否 → 打印日志"价格未变"
\`\`\`

### 详细配置

**设置目标价格**
\`\`\`
变量名：目标价格
值：100
类型：数字
\`\`\`

**获取当前价格**
\`\`\`
选择器：.price-now
提取类型：文本内容
保存到变量：当前价格文本

// 可能需要处理价格格式，如去掉"¥"符号
执行JavaScript：
  return parseFloat('{当前价格文本}'.replace(/[¥,]/g, ''));
保存到变量：当前价格
\`\`\`

**条件判断**
\`\`\`
左值：{当前价格}
运算符：<
右值：{目标价格}
\`\`\`

**发送通知（条件为真时）**
\`\`\`
收件人：your@email.com
主题：【降价提醒】商品降价了！
内容：
您关注的商品已降价！

当前价格：{当前价格} 元
目标价格：{目标价格} 元

快去抢购吧！
\`\`\`

---

## ✅ 案例5：自动签到

### 场景描述
每天自动登录网站完成签到任务。

### 工作流设计

\`\`\`
1. 打开网页 → 网站首页
2. 条件判断 → 是否已登录
   ├─ 否 → 执行登录流程
   └─ 是 → 继续
3. 打开签到页面
4. 条件判断 → 是否已签到
   ├─ 是 → 打印"今日已签到"
   └─ 否 → 点击签到按钮
5. 获取签到结果
6. 发送通知（可选）
\`\`\`

### 检查登录状态

\`\`\`
执行JavaScript：
  return document.querySelector('.user-avatar') !== null;
保存到变量：已登录

条件判断：{已登录} == true
\`\`\`

### 检查签到状态

\`\`\`
执行JavaScript：
  const btn = document.querySelector('.sign-btn');
  return btn && btn.classList.contains('signed');
保存到变量：已签到

条件判断：{已签到} == true
\`\`\`

---

## 📝 案例6：表单批量填写

### 场景描述
从Excel读取数据，批量填写网页表单。

### 工作流设计

\`\`\`
1. 读取Excel → 获取数据列表
2. 遍历数据列表
   ├─ 打开表单页面
   ├─ 填写姓名：{当前元素[姓名]}
   ├─ 填写电话：{当前元素[电话]}
   ├─ 填写邮箱：{当前元素[邮箱]}
   ├─ 点击提交
   ├─ 等待提交成功
   └─ 打印日志：已提交第 {当前索引} 条
\`\`\`

### 读取Excel数据

\`\`\`
读取Excel模块
文件路径：C:/data/contacts.xlsx
工作表：Sheet1
保存到变量：数据列表

// 数据格式示例：
// [{"姓名": "张三", "电话": "13800138000", "邮箱": "zhangsan@example.com"}, ...]
\`\`\`

### 遍历填写

\`\`\`
遍历列表：数据列表（直接填变量名）

- 打开网页：https://example.com/form

- 输入文本
  选择器：#name
  内容：{item[姓名]}

- 输入文本
  选择器：#phone
  内容：{item[电话]}

- 输入文本
  选择器：#email
  内容：{item[邮箱]}

- 点击元素：#submit-btn

- 等待元素：.success-message 出现

- 打印日志：已提交第 {index} 条数据：{item[姓名]}

- 等待：2000毫秒
\`\`\`

---

## 🔄 案例7：懒加载页面采集

### 场景描述
采集需要滚动加载的页面（如微博、知乎等）。

### 工作流设计

\`\`\`
1. 打开网页
2. 设置变量：已采集数量 = 0
3. 设置变量：目标数量 = 100
4. 循环执行（{已采集数量} < {目标数量}）
   ├─ 获取当前可见的数据
   ├─ 更新已采集数量
   ├─ 滚动到页面底部
   ├─ 等待新内容加载
   └─ 条件判断：是否还有更多
       └─ 否 → 跳出循环
\`\`\`

### 滚动加载逻辑

\`\`\`
执行JavaScript：
  // 获取当前已加载的项目数
  return document.querySelectorAll('.feed-item').length;
保存到变量：当前数量

// 滚动到底部
滚动页面：到底部

// 等待新内容加载
等待：2000毫秒

// 检查是否加载了新内容
执行JavaScript：
  return document.querySelectorAll('.feed-item').length;
保存到变量：新数量

// 判断是否还有更多
条件判断：{新数量} > {当前数量}
  ├─ 是 → 跳过当前循环
  └─ 否 → 跳出循环（已到底部）
\`\`\`

---

## 🤖 案例8：AI辅助数据处理

### 场景描述
采集评论数据，使用AI进行情感分析和分类。

### 工作流设计

\`\`\`
1. 采集评论列表
2. 遍历评论
   ├─ AI大脑 → 分析情感
   ├─ 保存结果到Excel
\`\`\`

### AI分析配置

\`\`\`
AI大脑模块

系统提示词：
你是一个评论分析专家。请分析用户评论的情感倾向和主要观点。
以JSON格式输出：
{
  "sentiment": "正面/负面/中性",
  "score": 0-100的情感分数,
  "keywords": ["关键词1", "关键词2"],
  "summary": "一句话总结"
}
只输出JSON，不要其他内容。

用户消息：
请分析以下评论：
{当前评论}

保存到变量：分析结果
\`\`\`

### 保存分析结果

\`\`\`
// 解析AI返回的JSON
执行JavaScript：
  try {
    return JSON.parse('{分析结果}');
  } catch(e) {
    return {sentiment: "未知", score: 0, keywords: [], summary: ""};
  }
保存到变量：分析数据

// 保存到Excel
设置变量（Excel列名：情感）：{分析数据[sentiment]}
设置变量（Excel列名：分数）：{分析数据[score]}
设置变量（Excel列名：摘要）：{分析数据[summary]}
\`\`\`

---

## 🗄️ 案例9：数据采集入库

### 场景描述
采集网页数据并保存到MySQL数据库中。

### 工作流设计

\`\`\`
1. 连接数据库
2. 打开网页 → 商品列表页
3. 遍历商品列表
   ├─ 获取商品名称
   ├─ 获取商品价格
   ├─ 获取商品链接
   └─ 插入数据到数据库
4. 关闭数据库连接
5. 打印日志：采集完成
\`\`\`

### 详细配置

**步骤1：连接数据库**
\`\`\`
主机地址：localhost
端口：3306
用户名：root
密码：{数据库密码}
数据库名：web_rpa
连接名称：default
\`\`\`

**步骤2-3：采集并入库**
\`\`\`
遍历列表：商品元素列表

- 获取元素信息
  选择器：{item} .product-title
  保存到变量：商品名称

- 获取元素信息
  选择器：{item} .product-price
  保存到变量：价格

- 获取元素信息
  选择器：{item} a
  属性：href
  保存到变量：链接

- 插入数据
  表名：products
  数据：{
    "name": "{商品名称}",
    "price": "{价格}",
    "url": "{链接}",
    "created_at": "{当前时间}"
  }
  插入ID保存到：新ID

- 打印日志：已插入商品 {商品名称}，ID：{新ID}
\`\`\`

**步骤4：关闭连接**
\`\`\`
关闭数据库连接
连接名称：default
\`\`\`

### 数据库表结构

\`\`\`sql
CREATE TABLE products (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  price DECIMAL(10,2),
  url VARCHAR(500),
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
\`\`\`

---

## 🔄 案例10：数据库数据同步

### 场景描述
从数据库读取待处理数据，处理后更新状态。

### 工作流设计

\`\`\`
1. 连接数据库
2. 查询待处理数据
3. 遍历数据
   ├─ 执行处理逻辑（如API请求）
   └─ 更新数据库状态
4. 关闭连接
\`\`\`

### 详细配置

**查询待处理数据**
\`\`\`
查询数据：
  SQL：SELECT * FROM tasks WHERE status = 0 LIMIT 100
  保存到变量：待处理列表
\`\`\`

**遍历处理**
\`\`\`
遍历列表：待处理列表

- API请求：处理任务
  URL：https://api.example.com/process
  方法：POST
  请求体：{"task_id": "{item[id]}", "data": "{item[data]}"}
  保存到：处理结果

- 条件判断：{处理结果[success]} == true
  ├─ 是 → 更新数据
  │        表名：tasks
  │        数据：{"status": 1, "result": "{处理结果[data]}"}
  │        WHERE：id = {item[id]}
  └─ 否 → 更新数据
           表名：tasks
           数据：{"status": -1, "error": "{处理结果[error]}"}
           WHERE：id = {item[id]}
\`\`\`

---

## 💡 案例设计技巧

### 1. 模块化设计
- 将重复的操作封装成独立的流程段
- 使用变量传递数据

### 2. 错误处理
- 添加条件判断检查关键步骤
- 设置合理的超时和重试
- 使用打印日志记录关键信息

### 3. 稳定性优化
- 使用等待元素而非固定等待
- 添加适当的延迟避免被检测
- 处理各种异常情况

### 4. 数据验证
- 采集后检查数据完整性
- 去重处理
- 格式化数据`
